var Growl=RightJS.Growl=(function(document,RightJS){var R=RightJS,$=RightJS.$,$w=RightJS.$w,Object=RightJS.Object,Element=RightJS.Element;function Widget(tag_name,methods){if(!methods){methods=tag_name;tag_name='DIV';}
var AbstractWidget=new RightJS.Wrapper(RightJS.Element.Wrappers[tag_name]||RightJS.Element,{initialize:function(key,options){this.key=key;var args=[{'class':'rui-'+key}];if(!(this instanceof RightJS.Input||this instanceof RightJS.Form)){args.unshift(tag_name);}
this.$super.apply(this,args);if(RightJS.isString(options)){options=RightJS.$(options);}
if(options instanceof RightJS.Element){this._=options._;if('$listeners'in options){options.$listeners=options.$listeners;}
options={};}
this.setOptions(options,this);return this;},setOptions:function(options,element){element=element||this;RightJS.Options.setOptions.call(this,RightJS.Object.merge(options,eval("("+(element.get('data-'+this.key)||'{}')+")")));return this;}});var Klass=new RightJS.Wrapper(AbstractWidget,methods);RightJS.Observer.createShortcuts(Klass.prototype,Klass.EVENTS||[]);return Klass;}
var Button=new RightJS.Wrapper(RightJS.Element,{initialize:function(caption,options){this.$super('div',options);this._.innerHTML=caption;this.addClass('rui-button');this.on('selectstart','stopEvent');},disable:function(){return this.addClass('rui-button-disabled');},enable:function(){return this.removeClass('rui-button-disabled');},disabled:function(){return this.hasClass('rui-button-disabled');},enabled:function(){return!this.disabled();},fire:function(){if(this.enabled()){this.$super.apply(this,arguments);}
return this;}});var Growl=new Widget('DIV',{extend:{version:'1.0',Options:{duration:500,timer:4000,sticky:false,transparentPng:false},i18n:{Close:'Close'}},initialize:function(content,options){this.$super('growl',options);this.addClass('growl');if(!this.options.sticky){this.addClass('not-sticky');}
this.insert([this.close=new Button(Growl.i18n.Close,{title:Growl.i18n.Close,'class':'close'}),this.content=$E('div',{'class':'content'}).html(content),this.bottom=$E('div',{'class':'bottom'})]);this.onClick(this._clicked);if(!Growl.container){Growl.container=$E('div',{id:'growl-container'}).insertTo(document.body);Growl.container.disappearInterval=setInterval(function(){var topGrowl=Growl.container.first('.not-sticky');if(topGrowl&&!defined(topGrowl.timeout)){topGrowl.timeout=setTimeout(function(){topGrowl._disappear();},topGrowl.options.timer);}},200);}
this._appear();},_appear:function(){if(Browser.IE&&this.options.transparentPng){this.insertTo(Growl.container);}else{this.setStyle({opacity:0}).insertTo(Growl.container).morph({opacity:1},{duration:this.options.duration});}},_disappear:function(){if(Browser.IE&&this.options.transparentPng){this.remove();}else{this.morph({opacity:0},{duration:this.options.duration,onFinish:function(){this.element.morph({height:'0'},{duration:this.element.options.duration,onFinish:function(){this.element.remove();}});}});}},_clicked:function(e){var target=e.target;if(target==this.close){this._disappear();}}});Element.include({growl:function(options){return new Growl(this,options);}});document.write("<style type=\"text/css\">#growl-container{position:fixed;top:0;right:0;}</style>");return Growl;})(document,RightJS);
